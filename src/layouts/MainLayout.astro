---
import '../styles/global.css';
import CommonScripts from '../components/layout/CommonScripts.astro';
import Favicons from '../components/seo/Favicons.astro';
import HomeNavbar from '../components/layout/navbar/HomeNavbar.astro';
import Footer from '../components/layout/footer/Footer.astro';
import { MetaTags } from '../features/meta-tags/components';
import { AIMetadata } from '../features/ai-metadata';
import { AutoSchema } from '../features/schema';
import { ThemeScript } from '../features/dark-light-mode/components';

interface Props {
    title: string;
    description?: string;
    image?: string;
    imageAlt?: string;
    type?: 'website' | 'article';
    keywords?: string[];
    publishedDate?: string;
    modifiedDate?: string;
}

const {
    title,
    description = "Mat√≠as Cappato - Desarrollador web especializado en crear experiencias digitales modernas y accesibles.",
    image,
    imageAlt,
    type = 'website',
    keywords = [],
    publishedDate,
    modifiedDate
} = Astro.props;

// Convertir fechas a objetos Date si son strings
const pubDate = publishedDate ? new Date(publishedDate) : undefined;
const modDate = modifiedDate ? new Date(modifiedDate) : undefined;

const currentUrl = Astro.url.pathname;
---

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title}</title>

    <!-- Script anti-flicker (debe ir lo antes posible) -->
    <ThemeScript />
    <MetaTags
        title={title}
        description={description}
        image={image ? { url: image, alt: imageAlt } : undefined}
        type={type}
        keywords={keywords}
        publishedDate={pubDate}
        modifiedDate={modDate}
    />
    <AIMetadata
        title={title}
        description={description}
        type={type}
        url={currentUrl}
        datePublished={pubDate}
        dateModified={modDate}
        tags={keywords}
    />
    <Favicons />

    <!-- Schema.org structured data - FULLY AUTOMATED -->
    <AutoSchema />

    <CommonScripts />
</head>
<body class="font-sans overflow-x-hidden transition-theme">
    <HomeNavbar />
    <slot />
    <Footer />
</body>
</html>












