---
/**
 * Blog Enhancement Feature - Breadcrumbs Component
 * 
 * Navegación jerárquica para mejorar UX y SEO
 * Soporta múltiples niveles y structured data
 */

interface Props {
  items: BreadcrumbItem[];
  className?: string;
}

interface BreadcrumbItem {
  label: string;
  href?: string;
  current?: boolean;
}

const { items, className = '' } = Astro.props;

// Generar structured data para SEO
const structuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": items.map((item, index) => ({
    "@type": "ListItem",
    "position": index + 1,
    "name": item.label,
    ...(item.href && { "item": `https://cappato.dev${item.href}` })
  }))
};
---

<!-- Structured Data para SEO -->
<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

<!-- Breadcrumbs Navigation -->
<nav 
  aria-label="Breadcrumb" 
  class={`breadcrumbs ${className}`}
  role="navigation"
>
  <ol class="breadcrumbs__list">
    {items.map((item, index) => (
      <li class="breadcrumbs__item">
        {item.current ? (
          <span 
            class="breadcrumbs__current"
            aria-current="page"
          >
            {item.label}
          </span>
        ) : (
          <a 
            href={item.href}
            class="breadcrumbs__link"
          >
            {item.label}
          </a>
        )}
        
        {index < items.length - 1 && (
          <svg 
            class="breadcrumbs__separator" 
            width="16" 
            height="16" 
            viewBox="0 0 16 16"
            aria-hidden="true"
          >
            <path 
              d="M6 4l4 4-4 4" 
              stroke="currentColor" 
              stroke-width="2" 
              fill="none"
            />
          </svg>
        )}
      </li>
    ))}
  </ol>
</nav>

<style>
  .breadcrumbs {
    margin-bottom: 1.5rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--color-border);
  }
  
  .breadcrumbs__list {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.5rem;
    list-style: none;
    margin: 0;
    padding: 0;
    font-size: 0.875rem;
  }
  
  .breadcrumbs__item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .breadcrumbs__link {
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color 0.2s ease;
    
    &:hover {
      color: var(--color-primary);
      text-decoration: underline;
    }
    
    &:focus {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
      border-radius: 2px;
    }
  }
  
  .breadcrumbs__current {
    color: var(--color-text-primary);
    font-weight: 500;
  }
  
  .breadcrumbs__separator {
    color: var(--color-text-tertiary);
    flex-shrink: 0;
  }
  
  /* Dark mode adjustments */
  :global(.dark) .breadcrumbs {
    border-bottom-color: var(--color-border-dark);
  }
  
  /* Mobile responsive */
  @media (max-width: 640px) {
    .breadcrumbs {
      margin-bottom: 1rem;
      padding: 0.5rem 0;
    }
    
    .breadcrumbs__list {
      font-size: 0.8125rem;
      gap: 0.375rem;
    }
    
    .breadcrumbs__item {
      gap: 0.375rem;
    }
    
    .breadcrumbs__separator {
      width: 14px;
      height: 14px;
    }
  }
  
  /* High contrast mode */
  @media (prefers-contrast: high) {
    .breadcrumbs__link {
      text-decoration: underline;
    }
    
    .breadcrumbs__current {
      font-weight: 600;
    }
  }
  
  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .breadcrumbs__link {
      transition: none;
    }
  }
</style>
